---
title: 疑難排解 Surface Hub 上的 Miracast
description: 了解如何使用 Surface Hub 上的 Miracast 解決問題。
ms.prod: surface-hub
ms.sitesec: library
author: dansimp
ms.author: dansimp
ms.topic: article
ms.date: 06/20/2019
ms.reviewer: ''
manager: laurawi
ms.localizationpriority: medium
ms.openlocfilehash: 96c7c42fe0176f275a8657165d88bf447e57772b
ms.sourcegitcommit: 109d1d7608ac4667564fa5369e8722e569b8ea36
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2020
ms.locfileid: "10834192"
---
# <span data-ttu-id="2b62b-103">疑難排解 Surface Hub 上的 Miracast</span><span class="sxs-lookup"><span data-stu-id="2b62b-103">Troubleshoot Miracast on Surface Hub</span></span>

<span data-ttu-id="2b62b-104">Surface Hub 透過 Miracast 通訊協定支援無線投影。</span><span class="sxs-lookup"><span data-stu-id="2b62b-104">Surface Hub supports wireless projection through the Miracast protocol.</span></span> <span data-ttu-id="2b62b-105">大部分無線顯示器和可用的介面卡目前使用 Miracast 原始的實作。</span><span class="sxs-lookup"><span data-stu-id="2b62b-105">Most wireless monitors and adapters available today use the original implementation of Miracast.</span></span> <span data-ttu-id="2b62b-106">Surface Hub 使用稍有不同的 Miracast 版本稱為 **Miracast Autonomous Group Owner (AGO)**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-106">Surface Hub uses a slightly different version of Miracast known as **Miracast Autonomous Group Owner (AGO)**.</span></span> <span data-ttu-id="2b62b-107">當無線投影至 Surface Hub 失敗時的常見疑難排解步驟是測試投影到另一個無線顯示器或介面卡。</span><span class="sxs-lookup"><span data-stu-id="2b62b-107">A common troubleshooting step when projecting wirelessly to Surface Hub fails is to test projecting to another wireless monitor or adapter.</span></span> <span data-ttu-id="2b62b-108">但是，在大部分情況下，這些裝置不使用 Miracast AGO 前，並且不以和 Surface Hub 相同的方式處理無線投影。</span><span class="sxs-lookup"><span data-stu-id="2b62b-108">However, in most cases, these devices are not using Miracast AGO and do not handle wireless projection the same way that Surface Hub does.</span></span>

<span data-ttu-id="2b62b-109">在傳統 Miracast 中，投影裝置將連接支援 Miracast 的監視器設定的存取點，然後監視器將會使用投影裝置的網路通道，傳送流量資料回到投影裝置。</span><span class="sxs-lookup"><span data-stu-id="2b62b-109">In traditional Miracast, the projecting device will connect the access point set up by the Miracast-enabled monitor, and then the monitor will send traffic back to the projecting device using the network channel of the projecting device.</span></span> <span data-ttu-id="2b62b-110">Miracast AGO 是兩步驟連線程序：</span><span class="sxs-lookup"><span data-stu-id="2b62b-110">Miracast AGO is a two-step connection process:</span></span>

- <span data-ttu-id="2b62b-111">第一個步驟是使用 2.4 GHz 的初始連線。</span><span class="sxs-lookup"><span data-stu-id="2b62b-111">The first step is an initial connection using 2.4GHz.</span></span> 
- <span data-ttu-id="2b62b-112">該初始交握之後，投射裝置會使用監視器上的無線通道設定傳送流量至監視器。</span><span class="sxs-lookup"><span data-stu-id="2b62b-112">After that initial handshake, the projecting device sends traffic to the monitor using the wireless channel settings on the monitor.</span></span> <span data-ttu-id="2b62b-113">如果 Surface Hub 已連接到 Wi-Fi 網路的存取點，將會使用相同的通道做為連接的網路，否則會使用 [設定] 的 Miracast 通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-113">If Surface Hub is connected to a Wi-Fi network, the access point, it will use the same channel as the connected network, otherwise it will use the Miracast channel from Settings.</span></span>

<span data-ttu-id="2b62b-114">通常 Miracast 連到 Surface Hub 的問題有兩種類型：[連線](#connect-issues)和[效能](#performance-issues)。</span><span class="sxs-lookup"><span data-stu-id="2b62b-114">There are generally two types of issues with Miracast to Surface Hub: [connection](#connect-issues) and [performance](#performance-issues).</span></span> <span data-ttu-id="2b62b-115">在任何一種情況下，最好在 Surface Hub 的位置中取得無線網路活動的一般圖片。</span><span class="sxs-lookup"><span data-stu-id="2b62b-115">In either case, it is a good idea to get a general picture of wireless network activity in the Surface Hub's location.</span></span> <span data-ttu-id="2b62b-116">執行網路掃描工具會顯示可用的網路和環境中通道使用量。</span><span class="sxs-lookup"><span data-stu-id="2b62b-116">Running a network scanning tool will show you the available networks and channel usage in the environment.</span></span>

## <a name="connect-issues"></a><span data-ttu-id="2b62b-117">連接問題</span><span class="sxs-lookup"><span data-stu-id="2b62b-117">Connect issues</span></span>

<span data-ttu-id="2b62b-118">請確定 Surface Hub 上 [設定] 中已啟用 Miracast 和 Wi-Fi。</span><span class="sxs-lookup"><span data-stu-id="2b62b-118">Ensure both Wi-Fi and Miracast are both enabled in Settings on Surface Hub.</span></span> 

<span data-ttu-id="2b62b-119">如果您在執行掃描網路，您應該會看到 Surface Hub Miracast 被列示為一個存取點。</span><span class="sxs-lookup"><span data-stu-id="2b62b-119">If you ran a network scan, you should see Surface Hub Miracast listed as an access point.</span></span> <span data-ttu-id="2b62b-120">如果 Surface Hub 的 Miracast 網路出現在掃描上，但您無法將它顯示為可用的裝置，您可以嘗試調整 Surface Hub 所使用的 Miracast 通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-120">If Surface Hub's Miracast network shows up on the scan, but you cannot not see it as an available device, you can try to adjust the Miracast channel used by Surface Hub.</span></span> 

<span data-ttu-id="2b62b-121">當 Surface Hub 連接 Wi-Fi 網路時，它會使用相同的通道設定做為其 Miracast 存取點的 Wi-Fi 存取點。</span><span class="sxs-lookup"><span data-stu-id="2b62b-121">When Surface Hub is connected to a Wi-Fi network it will use the same channel settings as the Wi-Fi access point for its Miracast access point.</span></span> <span data-ttu-id="2b62b-122">基於疑難排解之目的，中斷 Surface Hub 與任何 Wi-Fi 網路的連線 (但保持 Wi-Fi 連線)，如此您便可以控制 Miracast 所使用的通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-122">For troubleshooting purposes, disconnect Surface Hub from any Wi-Fi networks (but keep Wi-Fi enabled), so you can control the channel used for Miracast.</span></span> <span data-ttu-id="2b62b-123">您可以手動選取設定中的 Miracast 通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-123">You can manually select the Miracast channel in Settings.</span></span> <span data-ttu-id="2b62b-124">您需要在變更後重新啟動 Surface Hub。</span><span class="sxs-lookup"><span data-stu-id="2b62b-124">You will need to restart Surface Hub after each change.</span></span> <span data-ttu-id="2b62b-125">一般而言，您會想要使用未顯示網路掃描之龐大使用量的通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-125">Generally speaking, you will want to use channels that do not show heavy utilization from the network scan.</span></span>

<span data-ttu-id="2b62b-126">連接問題也可能是連線裝置的問題所造成。</span><span class="sxs-lookup"><span data-stu-id="2b62b-126">It is also possible that the connect issue can be the result of a problem on the connecting device.</span></span> <span data-ttu-id="2b62b-127">如果投影裝置正在執行 Windows，它應該會是 Miracast 完整支援的 Windows 8.1 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="2b62b-127">If the projecting device is running Windows, it should be Windows 8.1 or newer for full Miracast support.</span></span> <span data-ttu-id="2b62b-128">疑難排解時，再次中斷投影裝置與任何 Wi-Fi 網路的連線。</span><span class="sxs-lookup"><span data-stu-id="2b62b-128">Again, for troubleshooting, disconnect the projecting device from any Wi-Fi networks.</span></span> <span data-ttu-id="2b62b-129">這將會消除存取點通道和 Surface Hub 上設定的 Miracast 頻道之間的任何通道切換。</span><span class="sxs-lookup"><span data-stu-id="2b62b-129">This will eliminate any channel switching between the access point channel and the Miracast channel set on Surface Hub.</span></span> <span data-ttu-id="2b62b-130">此外，部分群組原則和防火牆設定可能繫結 Wi-Fi 網路。</span><span class="sxs-lookup"><span data-stu-id="2b62b-130">Also, some Group Policy and firewall settings may be tied to a Wi-Fi network.</span></span>

### <a name="check-drivers"></a><span data-ttu-id="2b62b-131">檢查驅動程式</span><span class="sxs-lookup"><span data-stu-id="2b62b-131">Check drivers</span></span>

<span data-ttu-id="2b62b-132">最好也能確定最新驅動程式和投影裝置上安裝的更新。</span><span class="sxs-lookup"><span data-stu-id="2b62b-132">It is also a good idea to ensure the latest drivers and updates are installed on the projecting device.</span></span> <span data-ttu-id="2b62b-133">在 [裝置管理員] 中，開啟 Wi-Fi 介面卡和視訊介面卡，並檢查是否有更新的驅動程式版本。</span><span class="sxs-lookup"><span data-stu-id="2b62b-133">In Device Manager, open the Wi-Fi adapter and video adapter and check for an updated driver version.</span></span> <span data-ttu-id="2b62b-134">我們強烈建議 Surface Pro 3 和 Surface Pro 4 若在較舊的 Wi-Fi 驅動程式上時使用 [Hotfix 3120232](https://support.microsoft.com/help/3120232/poor-wireless-performance-on-5-ghz-connections-on-surface-pro-3-and-surface-3)。</span><span class="sxs-lookup"><span data-stu-id="2b62b-134">[Hotfix 3120232](https://support.microsoft.com/help/3120232/poor-wireless-performance-on-5-ghz-connections-on-surface-pro-3-and-surface-3) is highly recommended for Surface Pro 3 and Surface Pro 4 if they are on an older Wi-Fi driver.</span></span> 

### <a name="check-for-miracast-support"></a><span data-ttu-id="2b62b-135">檢查是否有 Miracast 支援</span><span class="sxs-lookup"><span data-stu-id="2b62b-135">Check for Miracast support</span></span>

<span data-ttu-id="2b62b-136">接著，確定裝置有支援 Miracast。</span><span class="sxs-lookup"><span data-stu-id="2b62b-136">Next, ensure Miracast is supported on the device.</span></span> 

1. <span data-ttu-id="2b62b-137">按下 Windows 鍵 + R 鍵並輸入 `dxdiag`。</span><span class="sxs-lookup"><span data-stu-id="2b62b-137">Press Windows Key + R and type `dxdiag`.</span></span> 
2. <span data-ttu-id="2b62b-138">按一下 [儲存所有資訊]。</span><span class="sxs-lookup"><span data-stu-id="2b62b-138">Click "Save all information".</span></span> 
3. <span data-ttu-id="2b62b-139">開啟已儲存的 dxdiag.txt 並尋找 **Miracast**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-139">Open the saved dxdiag.txt and find **Miracast**.</span></span> <span data-ttu-id="2b62b-140">它應該會顯示 **/[對於 HDCP 可用/]**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-140">It should say **Available, with HDCP**.</span></span> 
    
### <a name="check-firewall"></a><span data-ttu-id="2b62b-141">檢查防火牆</span><span class="sxs-lookup"><span data-stu-id="2b62b-141">Check firewall</span></span>
    
<span data-ttu-id="2b62b-142">Windows 防火牆可以封鎖 Miracast 流量。</span><span class="sxs-lookup"><span data-stu-id="2b62b-142">The Windows firewall can block Miracast traffic.</span></span> <span data-ttu-id="2b62b-143">最簡單的測試是停用防火牆及測試投影。</span><span class="sxs-lookup"><span data-stu-id="2b62b-143">The simplest test is to disable the firewall and test projection.</span></span> <span data-ttu-id="2b62b-144">如果 Miracast 搭配防火牆停用，請新增例外</span><span class="sxs-lookup"><span data-stu-id="2b62b-144">If Miracast works with the firewall disabled, add an exception for</span></span>

    C:\Windows\System32\WUDFHost.exe
    Allow In/Out connections for TCP and UDP, Ports: All.

### <a name="check-group-policy-settings"></a><span data-ttu-id="2b62b-145">TPM 群組原則設定</span><span class="sxs-lookup"><span data-stu-id="2b62b-145">Check Group Policy settings</span></span>

<span data-ttu-id="2b62b-146">在加入網域的裝置上，群組原則也會封鎖 Miracast。</span><span class="sxs-lookup"><span data-stu-id="2b62b-146">On domain-joined devices, Group Policy can also block Miracast.</span></span> 

1. <span data-ttu-id="2b62b-147">使用 Windows 鍵 + R 鍵並輸入 `rsop.msc`，以執行 **/[原則結果組/]** 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="2b62b-147">Use the Windows Key + R and type `rsop.msc` to execute the **Resultant Set of Policy** snap-in.</span></span> <span data-ttu-id="2b62b-148">這將會顯示目前套用到電腦的原則。</span><span class="sxs-lookup"><span data-stu-id="2b62b-148">This will show the current policies applied to the PC.</span></span> 
2. <span data-ttu-id="2b62b-149">檢閱 **/[電腦設定/]** > **/[Windows 設定/]** > **/[安全性設定/]** > **/[無線網路 (IEEE 802.11) 原則/]**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-149">Review **Computer Configuration** > **Windows Settings** > **Security Settings** > **Wireless Network (IEEE 802.11) Policies**.</span></span> <span data-ttu-id="2b62b-150">應該會有無線原則的設定。</span><span class="sxs-lookup"><span data-stu-id="2b62b-150">There should be a setting for wireless policies.</span></span> 
3. <span data-ttu-id="2b62b-151">按兩下無線原則設定，將會出現對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2b62b-151">Double click the setting for wireless policies and a dialog box will appear.</span></span> 
4. <span data-ttu-id="2b62b-152">開啟 **/[網路權限/]** 索引標籤，並選取 **/[允許每個人建立所有使用者的設定檔/]**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-152">Open the **Network Permissions** tab and select **Allow everyone to create all user profiles**.</span></span>

### <a name="check-event-logs"></a><span data-ttu-id="2b62b-153">檢查事件記錄</span><span class="sxs-lookup"><span data-stu-id="2b62b-153">Check event logs</span></span>

<span data-ttu-id="2b62b-154">最後要檢查的地方是事件記錄。</span><span class="sxs-lookup"><span data-stu-id="2b62b-154">The last place to check is in the Event logs.</span></span> <span data-ttu-id="2b62b-155">Miracast 事件將記錄到 **Wlanautoconfig**。</span><span class="sxs-lookup"><span data-stu-id="2b62b-155">Miracast events will be logged to **Wlanautoconfig**.</span></span> <span data-ttu-id="2b62b-156">這對於 Surface Hub 和投影裝置皆為真。</span><span class="sxs-lookup"><span data-stu-id="2b62b-156">This is true on both Surface Hub and the projecting device.</span></span> <span data-ttu-id="2b62b-157">如果您匯出 Surface Hub 記錄，您可以在 [ **WindowsEventLog** ] 資料夾中，查看 Surface Hub 的 Wlanautoconfig。</span><span class="sxs-lookup"><span data-stu-id="2b62b-157">If you export Surface Hub logs, you can view Surface Hub's Wlanautoconfig in the **WindowsEventLog** folder.</span></span> <span data-ttu-id="2b62b-158">事件記錄中的錯誤可以提供有關連線失敗位置的一些詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="2b62b-158">Errors in the event log can provide some additional details on where the connection fails.</span></span>

## <a name="performance-issues"></a><span data-ttu-id="2b62b-159">效能問題</span><span class="sxs-lookup"><span data-stu-id="2b62b-159">Performance issues</span></span>

<span data-ttu-id="2b62b-160">連接無線投影後，可能會造成效能延遲問題。</span><span class="sxs-lookup"><span data-stu-id="2b62b-160">After wireless projection is connected, it is possible to see performance issues causing latency.</span></span> <span data-ttu-id="2b62b-161">這通常是整體通道飽和或是造成通道切換的飽和結果。</span><span class="sxs-lookup"><span data-stu-id="2b62b-161">This is generally a result of overall channel saturation or a situation that causes channel switching.</span></span> 

<span data-ttu-id="2b62b-162">對通道飽和，請參考網路掃描，然後嘗試使用較少流量的通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-162">For channel saturation, refer to the network scan and try to use channels with less traffic.</span></span>

<span data-ttu-id="2b62b-163">當 Wi-Fi 介面卡需傳送流量至多個通道時，造成通道切換。</span><span class="sxs-lookup"><span data-stu-id="2b62b-163">Channel switching is caused when the Wi-Fi adapter needs to send traffic to multiple channels.</span></span> <span data-ttu-id="2b62b-164">某些通道支援動態頻率選擇 (DFS)。</span><span class="sxs-lookup"><span data-stu-id="2b62b-164">Certain channels support Dynamic Frequency Selection (DFS).</span></span> <span data-ttu-id="2b62b-165">DFS 可用於通道 49 至 148。</span><span class="sxs-lookup"><span data-stu-id="2b62b-165">DFS is used on channels 49 through 148.</span></span> <span data-ttu-id="2b62b-166">有些 Wi-Fi 驅動程式會顯示連接 DFS 通道時效能不佳。</span><span class="sxs-lookup"><span data-stu-id="2b62b-166">Some Wi-Fi drivers will show poor performance when connected to a DFS channel.</span></span> <span data-ttu-id="2b62b-167">如果發現連接到 DFS 通道時 Miracast 效能不佳，請嘗試投影在非 DFS 通道上。</span><span class="sxs-lookup"><span data-stu-id="2b62b-167">If you are seeing poor Miracast performance while connected to a DFS channel, try the projection on a non-DFS channel.</span></span> <span data-ttu-id="2b62b-168">Surface Hub 和投影裝置都應該使用非 DFS 通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-168">Both Surface Hub and projecting device should use non-DFS channels.</span></span>

<span data-ttu-id="2b62b-169">如果 Surface Hub 和投影裝置均連接 Wi-Fi，但不同的通道使用不同的存取點，這會強制 Surface Hub 和投射裝置在連接 Miracast 時進行通道切換。</span><span class="sxs-lookup"><span data-stu-id="2b62b-169">If Surface Hub and the projecting device are both connected to Wi-Fi but using different access points with different channels, this will force Surface Hub and the projecting device to channel switch while Miracast is connected.</span></span> <span data-ttu-id="2b62b-170">這會造過 Wi-Fi 無線投影不佳和網路效能不穩定。</span><span class="sxs-lookup"><span data-stu-id="2b62b-170">This will result in both poor wireless project and poor network performance over Wi-Fi.</span></span> <span data-ttu-id="2b62b-171">不只無線投影效能被影響，通道切換將會影響所有無線流量效能。</span><span class="sxs-lookup"><span data-stu-id="2b62b-171">The channel switching will affect the performance of all wireless traffic, not just wireless projection.</span></span> 

<span data-ttu-id="2b62b-172">如果投影裝置連接與 Surface Hub 針對 Miracast 使用之通道不同的通道的 Wi-Fi 網路，也會發生通道切換。</span><span class="sxs-lookup"><span data-stu-id="2b62b-172">Channel switching will also occur if the projecting device is connected to an Wi-Fi network using a different channel than the channel that Surface Hub uses for Miracast.</span></span> <span data-ttu-id="2b62b-173">因此，最佳做法是將 Surface Hub 的 Miracast 通道設定為與最常使用的存取點相同的通道。</span><span class="sxs-lookup"><span data-stu-id="2b62b-173">So, a best practice is to set Surface Hub's Miracast channel to the same channel as the most commonly used access point.</span></span> 

<span data-ttu-id="2b62b-174">如果環境中有多個 Wi-Fi 網路或存取點，有些通道切換是無法避免的。</span><span class="sxs-lookup"><span data-stu-id="2b62b-174">If there are multiple Wi-Fi networks or access points in the environment, some channel switching is unavoidable.</span></span> <span data-ttu-id="2b62b-175">這可藉由確保所有 Wi-fi 驅動程式維持在最新狀態而獲得解決。</span><span class="sxs-lookup"><span data-stu-id="2b62b-175">This is best addressed by ensuring all Wi-Fi drivers are up to date.</span></span>

## <a name="contact-support"></a><span data-ttu-id="2b62b-176">連絡客戶支援</span><span class="sxs-lookup"><span data-stu-id="2b62b-176">Contact Support</span></span>

<span data-ttu-id="2b62b-177">如果您有任何疑問或需要協助，您可以[建立支援要求](https://support.microsoft.com/supportforbusiness/productselection)。</span><span class="sxs-lookup"><span data-stu-id="2b62b-177">If you have questions or need help, you can [create a support request](https://support.microsoft.com/supportforbusiness/productselection).</span></span>
